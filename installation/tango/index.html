


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://docs.autolabproject.com/installation/tango/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Tango - Autolab Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4dd2dd8d.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.6a5ad368.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-79424729-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="autolab" data-md-color-primary="" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tango-installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://docs.autolabproject.com/" title="Autolab Documentation" class="md-header-nav__button md-logo" aria-label="Autolab Documentation">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Autolab Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Tango
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/Autolab/autolab/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Autolab
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.autolabproject.com/" title="Autolab Documentation" class="md-nav__button md-logo" aria-label="Autolab Documentation">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    Autolab Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Autolab/autolab/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Autolab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Installation Overview" class="md-nav__link">
      Installation Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-compose/" title="Docker Compose Install" class="md-nav__link">
      Docker Compose Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Autolab
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Autolab" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Autolab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ubuntu/" title="Ubuntu 18.04" class="md-nav__link">
      Ubuntu 18.04
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../osx/" title="Mac OSX 10.11+" class="md-nav__link">
      Mac OSX 10.11+
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshoot/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mailing/" title="Mailing Setup" class="md-nav__link">
      Mailing Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Tango" class="md-nav__link md-nav__link--active">
      Tango
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Autolab Frontend
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Autolab Frontend" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon"></span>
        Autolab Frontend
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../instructors/" title="Guide for Instructors" class="md-nav__link">
      Guide for Instructors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lab/" title="Guide for Lab Authors" class="md-nav__link">
      Guide for Lab Authors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1-3" type="checkbox" id="nav-3-1-3">
    
    <label class="md-nav__link" for="nav-3-1-3">
      Features
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Features" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-3">
        <span class="md-nav__icon md-icon"></span>
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/formatted-feedback/" title="Formatted Feedback" class="md-nav__link">
      Formatted Feedback
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/scoreboards/" title="Scoreboards" class="md-nav__link">
      Scoreboards
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/embedded-forms/" title="Embedded Forms" class="md-nav__link">
      Embedded Forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/annotations/" title="Annotations" class="md-nav__link">
      Annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/moss/" title="MOSS Plagiarism Detection" class="md-nav__link">
      MOSS Plagiarism Detection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/metrics/" title="Metrics" class="md-nav__link">
      Metrics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../command-line-interface/" title="Autolab Frontend CLI" class="md-nav__link">
      Autolab Frontend CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tango-cli/" title="Tango CLI" class="md-nav__link">
      Tango CLI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/" title="Reference Overview" class="md-nav__link">
      Reference Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Autolab Frontend API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Autolab Frontend API" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        <span class="md-nav__icon md-icon"></span>
        Autolab Frontend API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api-interface/" title="Endpoints" class="md-nav__link">
      Endpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api-managing-authorized-apps/" title="Managing Authorized Apps" class="md-nav__link">
      Managing Authorized Apps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tango-rest/" title="Tango API" class="md-nav__link">
      Tango API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tango-vmms/" title="Tango VMMS API" class="md-nav__link">
      Tango VMMS API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Autolab/autolab/edit/master/docs/installation/tango.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="tango-installation">Tango Installation</h1>
<p>This guide provides instructions for installing Tango on either a <a href="#development-installation">development environment</a> or a <a href="#production-installation">production environment</a>.</p>
<h1 id="development-installation">Development Installation</h1>
<p>This guide shows how to setup Tango in a <strong>development environment</strong>. Use the <a href="#production-installation">production installation</a> guide for installing in a <strong>production environment</strong>.</p>
<ol>
<li>
<p>Obtain the source code.</p>
<div class="codehilite"><pre><span></span><code>git clone https://github.com/autolab/Tango.git<span class="p">;</span> <span class="nb">cd</span> Tango
</code></pre></div>


</li>
<li>
<p>Install Redis following <a href="http://redis.io/topics/quickstart" target="_blank">this guide</a>. By default, Tango uses Redis as a stateless job queue. Learn more <a href="https://autolab.github.io/2015/04/making-backend-scalable/" target="_blank">here</a>.</p>
</li>
<li>
<p>Create a <code>config.py</code> file from the given template.</p>
<div class="codehilite"><pre><span></span><code>cp config.template.py config.py
</code></pre></div>


</li>
<li>
<p>Create the course labs directory where job's output files will go, organized by key and lab name:</p>
<div class="codehilite"><pre><span></span><code>mkdir courselabs
</code></pre></div>


<p>By default the <code>COURSELABS</code> option in <code>config.py</code> points to the <code>courselabs</code> directory in the Tango directory.
Change this to specify another path if you wish.</p>
</li>
<li>
<p>Set up a VMMS for Tango to use.</p>
<ul>
<li><a href="#docker-vmms-setup">Docker</a> (<strong>recommended</strong>)</li>
<li><a href="#amazon-ec2-vmms-setup">Amazon EC2</a></li>
<li>TashiVMMS (deprecated)</li>
</ul>
</li>
<li>
<p>Run the following commands to setup the Tango dev environment inside the Tango directory. <a href="https://pip.pypa.io/en/stable/installing/" target="_blank">Install pip</a> if needed.</p>
<div class="codehilite"><pre><span></span><code>$ pip install virtualenv
$ virtualenv .
$ <span class="nb">source</span> bin/activate
$ pip install -r requirements.txt
$ mkdir volumes
</code></pre></div>


</li>
<li>
<p>If you are using Docker, set <code>DOCKER_VOLUME_PATH</code> in <code>config.py</code> to be the path to the <code>volumes</code> directory you just created.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">DOCKER_VOLUME_PATH</span> <span class="o">=</span> <span class="s2">&quot;/path/to/Tango/volumes/&quot;</span>
</code></pre></div>


</li>
<li>
<p>Start Redis by running the following command:</p>
<div class="codehilite"><pre><span></span><code>$ redis-server
</code></pre></div>


</li>
<li>
<p>Run the following command to start the server (producer). If no port is given, the server will run on the port specified in <code>config.py</code> (default: 3000):</p>
<div class="codehilite"><pre><span></span><code>python restful-tango/server.py &lt;port&gt;
</code></pre></div>


<p>Open another terminal window and start the job manager (consumer):</p>
<div class="codehilite"><pre><span></span><code>python jobManager.py
</code></pre></div>


<p>For more information on the job producer/consumer model check out our <a href="https://autolab.github.io/2015/04/making-backend-scalable/" target="_blank">blog post</a>.</p>
</li>
<li>
<p>Ensure Tango is running:</p>
<div class="codehilite"><pre><span></span><code>$ curl localhost:&lt;port&gt;
<span class="c1"># Hello, world! RESTful Tango here!</span>
</code></pre></div>


</li>
<li>
<p>You can test the Tango setup using the <a href="/tango-cli/">command line client</a>.</p>
</li>
<li>
<p>If you are using Tango with Autolab, you have to configure Autolab to use Tango. Go to your Autolab directory and enter the following commands:</p>
<div class="codehilite"><pre><span></span><code>cp config/autogradeConfig.rb.template config/autogradeConfig.rb
</code></pre></div>


<p>Fill in the correct info for your Tango deployment, mainly the following:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Hostname for Tango RESTful API</span>
<span class="no">RESTFUL_HOST</span> <span class="o">=</span> <span class="s2">&quot;foo.bar.edu&quot;</span> <span class="c1">#(if you are running Tango locally, then it is just &quot;localhost&quot;)</span>

<span class="c1"># Port for Tango RESTful API</span>
<span class="no">RESTFUL_PORT</span> <span class="o">=</span> <span class="s2">&quot;3000&quot;</span>

<span class="c1"># Key for Tango RESTful API</span>
<span class="no">RESTFUL_KEY</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
</code></pre></div>


</li>
<li>
<p>See below for instructions on how to deploy Tango in a standalone production environment.</p>
</li>
</ol>
<h1 id="production-installation">Production Installation</h1>
<p>This is a guide to setup a fully self-sufficient Tango deployment environment out-of-the-box using Docker. The suggested deployment pattern for Tango uses Nginx as a proxy and Supervisor as a process manager for Tango and all its dependencies. All requests to Nginx are rerouted to a Tango process.</p>
<h2 id="details">Details</h2>
<ul>
<li>Nginx default port - 8600</li>
<li>Tango ports - 8610, 8611</li>
<li>Redis port - 6379</li>
<li>You can change any of these in the respective config files in <code>deployment/config/</code> before you build the <code>tango_deployment</code> image.</li>
</ul>
<h2 id="steps">Steps</h2>
<ol>
<li>
<p>Clone the Tango repo</p>
<div class="codehilite"><pre><span></span><code>$ git clone https://github.com/autolab/Tango.git<span class="p">;</span> <span class="nb">cd</span> Tango
</code></pre></div>


</li>
<li>
<p>Create a <code>config.py</code> file from the given template.  </p>
<div class="codehilite"><pre><span></span><code>$ cp config.template.py config.py
</code></pre></div>


</li>
<li>
<p>Modify <code>DOCKER_VOLUME_PATH</code> in <code>config.py</code> as follows: </p>
<div class="codehilite"><pre><span></span><code><span class="nv">DOCKER_VOLUME_PATH</span> <span class="o">=</span> <span class="s1">&#39;/opt/TangoService/Tango/volumes/&#39;</span>
</code></pre></div>


</li>
<li>
<p>Install docker on the host machine by following instructions on the <a href="https://docs.docker.com/installation/" target="_blank">docker installation page</a>. Ensure docker is running:</p>
<div class="codehilite"><pre><span></span><code>$ docker ps
<span class="c1"># CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES</span>
</code></pre></div>


</li>
<li>
<p>Run the following command to build the Tango deployment image.</p>
<div class="codehilite"><pre><span></span><code>$ docker build --tag<span class="o">=</span><span class="s2">&quot;tango_deployment&quot;</span> .
</code></pre></div>


</li>
<li>
<p>Ensure the image was built by running.</p>
<div class="codehilite"><pre><span></span><code>$ docker images
<span class="c1"># REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="c1"># tango_deployment    latest              3c0d4f4b4958        2 minutes ago       742.6 MB</span>
<span class="c1"># ubuntu              15.04               d1b55fd07600        4 minutes ago       131.3 MB</span>
</code></pre></div>


</li>
<li>
<p>Run the following command to access the image in a container with a bash shell. The <code>-p</code> flag will map <code>nginxPort</code> on the docker container to <code>localPort</code> (8610 recommended) on your local machine (or on the VM that docker is running in on the local machine) so that Tango is accessible from outside the docker container.</p>
<div class="codehilite"><pre><span></span><code>$ docker run --privileged -p &lt;localPort&gt;:&lt;nginxPort&gt; -it tango_deployment /bin/bash
</code></pre></div>


</li>
<li>
<p>Set up a VMMS for Tango within the Docker container.</p>
<ul>
<li><a href="#docker-vmms-setup">Docker</a> (<strong>recommended</strong>)</li>
<li><a href="#amazon-ec2-vmms-setup">Amazon EC2</a></li>
</ul>
</li>
<li>
<p>Run the following command to start supervisor, which will then start Tango and all its dependencies.</p>
<div class="codehilite"><pre><span></span><code>$ service supervisor start
</code></pre></div>


</li>
<li>
<p>Check to see if Tango is responding to requests</p>
<div class="codehilite"><pre><span></span><code>$ curl localhost:8610 <span class="c1"># Hello, world! RESTful Tango here!</span>
</code></pre></div>


</li>
<li>
<p>Once you have a VMMS set up, leave the tango_deployment container by typing <code>exit</code> and once back in the host shell run the following command to get the name of your production container.</p>
<div class="codehilite"><pre><span></span><code>$ docker ps -as
<span class="c1"># CONTAINER ID        IMAGE               COMMAND               NAMES               SIZE</span>
<span class="c1"># c704d45c3737    tango_deployment       &quot;/bin/bash&quot;            erwin             40.26 MB</span>

The container created in this example has the name <span class="sb">`</span>erwin<span class="sb">`</span>.
</code></pre></div>


</li>
<li>
<p>The name of the production container can be changed by running the following command and will be used to run the container and create services.</p>
<div class="codehilite"><pre><span></span><code>$ docker rename &lt;old_name&gt; &lt;new_name&gt;
</code></pre></div>


</li>
<li>
<p>To reopen the container once it has been built use the following command. This will reopen the interactive shell within the container and allow for configuration of the container after its initial run.</p>
<div class="codehilite"><pre><span></span><code>$ docker start erwin
$ docker attach erwin
</code></pre></div>


</li>
<li>
<p>Once the container is set up with the autograding image, and the VMMS configured with any necessary software/environments needed for autograding (java, perl, etc), some configurations need to be changed to make the container daemon ready. Using the <code>CONTAINER ID</code> above, use the following commands to modify that containers <code>config.v2.json</code> file.</p>
<div class="codehilite"><pre><span></span><code>$ sudo ls  /var/lib/docker/containers
c704d45c37372a034cb97761d99f6f3f362707cc23d689734895e017eda3e55b
$ sudo vim /var/lib/docker/containers/c704d45c37372a034cb97761d99f6f3f362707cc23d689734895e017eda3e55b/config.v2.json
</code></pre></div>


</li>
<li>
<p>Edit the "Path" field in the config.v2.json file from "/bin/bash" to "/usr/bin/supervisord" and save the file. Run the following commands to verify the changes were successful. The COMMAND field should now be "/usr/bin/supervisord"</p>
<div class="codehilite"><pre><span></span><code>$ service docker restart
$ docker ps -as
<span class="c1"># CONTAINER ID        IMAGE               COMMAND               NAMES               SIZE</span>
<span class="c1"># c704d45c3737    tango_deployment   &quot;/usr/bin/supervisord&quot;     erwin             40.26 MB</span>
</code></pre></div>


</li>
<li>
<p>At this point when the container is started, the environment is fully set up and will no longer be an interactive shell. Instead, it will be the supervisor service that starts Tango and all its dependencies. Test this with the following commands and ensure Tango is functioning properly.</p>
<div class="codehilite"><pre><span></span><code>$ docker start erwin
<span class="c1"># (Test tango environment)</span>
$ docker stop erwin
</code></pre></div>


</li>
<li>
<p>Test the setup by running sample jobs using <a href="/tango-cli/">the testing guide</a>.</p>
<p><strong>The following steps are optional and should only be used if you would like the Tango container to start on system boot.</strong></p>
</li>
<li>
<p>To ensure Tango starts with the system in the production environment, the container needs to be configured as a service. Below is a sample service config file that needs to be changed to suit your environment and placed in <code>/etc/systemd/system/</code>. The file should be named <code>&lt;name&gt;.service</code>. For this example, it is <code>erwin.service</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>Docker Service Managing Tango Container
<span class="nv">Requires</span><span class="o">=</span>docker.service
<span class="nv">After</span><span class="o">=</span>docker.service

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Restart</span><span class="o">=</span>always
<span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/docker start -a erwin
<span class="nv">ExecStop</span><span class="o">=</span>/usr/bin/docker stop -t <span class="m">2</span> erwin

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>default.target
</code></pre></div>


</li>
<li>
<p>Test and ensure the service was set up correctly. The service should start successfully and remain running.</p>
<div class="codehilite"><pre><span></span><code>$ systemctl daemon-reload
$ service erwin start
$ service erwin status
</code></pre></div>


</li>
<li>
<p>Enable the service at system startup and reboot and ensure it starts with the host.</p>
<div class="codehilite"><pre><span></span><code>$ systemctl <span class="nb">enable</span> erwin.service
$ sudo reboot
<span class="c1"># (Server Reboots)</span>
$ service erwin status
</code></pre></div>


</li>
</ol>
<h1 id="docker-vmms-setup">Docker VMMS Setup</h1>
<p>This is a guide to set up Tango to run jobs inside Docker containers.</p>
<ol>
<li>
<p>Install docker on host machine by following instructions on the <a href="https://docs.docker.com/installation/" target="_blank">docker installation page</a>. Ensure docker is running:</p>
<div class="codehilite"><pre><span></span><code>$ docker ps <span class="c1"># CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES</span>
</code></pre></div>


</li>
<li>
<p>Build base Docker image from root Tango directory.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> path/to/Tango
docker build -t autograding_image vmms/
docker images autograding_image    <span class="c1"># Check if image built</span>
</code></pre></div>


</li>
<li>
<p>Update <code>VMMS_NAME</code> in <code>config.py</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># in config.py</span>
<span class="n">VMMS_NAME</span> <span class="o">=</span> <span class="s2">&quot;localDocker&quot;</span>
</code></pre></div>


</li>
</ol>
<h1 id="amazon-ec2-vmms-setup">Amazon EC2 VMMS Setup</h1>
<p>This is a guide to set up Tango to run jobs on an Amazon EC2 VM.</p>
<ol>
<li>
<p>Create an <a href="https://aws.amazon.com/" target="_blank">AWS Account</a> or use an existing one.</p>
</li>
<li>
<p>Obtain your <code>access_key_id</code> and <code>secret_access_key</code> by following the instructions <a href="http://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys" target="_blank">here</a>.</p>
</li>
<li>
<p>Add AWS Credentials to a file called <code>~/.boto</code> using the following format:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span>Credentials<span class="o">]</span>
    <span class="nv">aws_access_key_id</span> <span class="o">=</span> MYAMAZONTESTKEY12345
    <span class="nv">aws_secret_access_key</span> <span class="o">=</span> myawssecretaccesskey12345
</code></pre></div>


<p>Tango uses the <a href="http://boto.cloudhackers.com/en/latest/" target="_blank">Boto</a> Python package to interface with Amazon Web Services</p>
</li>
<li>
<p>In the AWS EC2 console, create an Ubuntu 14.04+ EC2 instance and save the <code>.pem</code> file in a safe location.</p>
</li>
<li>
<p>Copy the directory and contents of <code>autodriver/</code> in the Tango repo into the EC2 VM. For more help connecting to the EC2 instance follow <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html#AccessingInstancesLinuxSCP" target="_blank">this guide</a>.</p>
<div class="codehilite"><pre><span></span><code>chmod <span class="m">400</span> /path/my-key-pair.pem
scp -i /path/my-key-pair.pem -r autodriver/ ubuntu@&lt;ec2-host-name&gt;.compute-1.amazonaws.com:~/
</code></pre></div>


<p>The autodriver is used as a sandbox environment to run the job inside the VM. It limits Disk I/O, Disk Usage, monitors security, and controls other valuable <code>sudo</code> level resources.</p>
</li>
<li>
<p>In the EC2 VM, compile the autodriver.</p>
<div class="codehilite"><pre><span></span><code>$ <span class="nb">cd</span> autodriver/
$ make clean<span class="p">;</span> make
$ cp -p autodriver /usr/bin/autodriver
</code></pre></div>


</li>
<li>
<p>Create the <code>autograde</code> Linux user and directory. All jobs will be run under this user.</p>
<div class="codehilite"><pre><span></span><code>$ useradd autograde
$ mkdir autograde
$ chown autograde autograde
$ chown :autograde autograde
</code></pre></div>


</li>
<li>
<p>In the AWS EC2 console, create an AMI image from your EC2 VM. Use <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/creating-an-ami-ebs.html#how-to-create-ebs-ami" target="_blank">this guide</a> to create a custom AMI.</p>
</li>
<li>
<p>Exit the EC2 instance and edit the following values in <code>config.py</code> in the Tango directory.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># VMMS to use. Must be set to a VMMS implemented in vmms/ before</span>
<span class="c1"># starting Tango.  Options are: &quot;localDocker&quot;, &quot;distDocker&quot;,</span>
<span class="c1"># &quot;tashiSSH&quot;, and &quot;ec2SSH&quot;</span>
<span class="nv">VMMS_NAME</span> <span class="o">=</span> <span class="s2">&quot;ec2SSH&quot;</span>
<span class="c1">######</span>
<span class="c1"># Part 5: EC2 Constants</span>
<span class="c1">#</span>
<span class="nv">EC2_REGION</span> <span class="o">=</span> <span class="s1">&#39;us-east-1&#39;</span>             <span class="c1"># EC2 Region</span>
<span class="nv">EC2_USER_NAME</span> <span class="o">=</span> <span class="s1">&#39;ubuntu&#39;</span>             <span class="c1"># EC2 username</span>
<span class="nv">DEFAULT_AMI</span> <span class="o">=</span> <span class="s1">&#39;ami-4c99c35b&#39;</span>         <span class="c1"># Custom AMI Id</span>
<span class="nv">DEFAULT_INST_TYPE</span> <span class="o">=</span> <span class="s1">&#39;t2.micro&#39;</span>       <span class="c1"># Instance Type</span>
<span class="nv">DEFAULT_SECURITY_GROUP</span> <span class="o">=</span> <span class="s1">&#39;autolab-autograde-ec2&#39;</span>  <span class="c1"># Security Group with full access to EC2</span>
<span class="nv">SECURITY_KEY_PATH</span> <span class="o">=</span> <span class="s1">&#39;/path/to/my-key-pair.pem&#39;</span>    <span class="c1"># Absolute path to my-key-pair.pem</span>
<span class="nv">DYNAMIC_SECURITY_KEY_PATH</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>       <span class="c1"># Leave blank</span>
<span class="nv">SECURITY_KEY_NAME</span> <span class="o">=</span> <span class="s1">&#39;my-key-pair&#39;</span>    <span class="c1"># Name of the key file. Ex: if file name is &#39;my-key-pair.pem&#39;, fill value with &#39;my-key-pair&#39;</span>
<span class="nv">TANGO_RESERVATION_ID</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>           <span class="c1"># Leave as 1</span>
<span class="nv">INSTANCE_RUNNING</span> <span class="o">=</span> <span class="m">16</span>                <span class="c1"># Status code of a running instance, leave as 16</span>
</code></pre></div>


</li>
<li>
<p>You should now be ready to run Tango jobs on EC2! Use the <a href="/tango-cli/">Tango CLI</a> to test your setup.</p>
</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../mailing/" title="Mailing Setup" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Mailing Setup
              </div>
            </div>
          </a>
        
        
          <a href="../../instructors/" title="Guide for Instructors" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Guide for Instructors
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/Autolab" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://facebook.com/autolabproject" target="_blank" rel="noopener" title="facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ["navigation.tabs", "toc.integrate"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>